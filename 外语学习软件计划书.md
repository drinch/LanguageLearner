# 外语学习软件计划书

[toc]

## 计划

- [x] 设计功能，包括各语言收录内容设定，考核方式设定

- [x] 划分任务，设计代码大致框架，即需要哪些类，分别负责什么大体的功能

- [x] 设计各个类的功能对应的具体的函数

- [x] 设计各个窗口的简化界面

- [ ] 代码实现初版程序，调试问题

- [ ] 界面优化，设计更精良的界面

- [ ] 修改界面代码

- [ ] 书写相关文件，文档

## 任务

### 功能设计

各语言分别设计，包括英语，日语，俄语

主要功能包括，词库收集，搜索，考核

词库储存的内容包括，单词，释义，词性，各个变形，词缀，近义反义词，例句

采用以单词及释义为核心，附加各属性的形式，且需要一定的可发展性，来应对当前部分语言的语法学习不完全的问题

考核，形式包括考察释义，考察听力，考察拼写，考察变形

考察释义和听力采用单词选意和听力选意，尽量采用同词性，否则采用全随机

拼写采用释义拼写，提供随机例句，同时考察变形

此外，考核需要统计单词的记忆程度，自动规划每天需要记忆的单词

#### 考核时间设定

- 暂行方案

给单词分配得分参数，得分越高，越优先记忆，同时需要加速度参数，考核正确时降低，错误时升高

具体计算方法为：

需要考核单词时，按照单词得分参数$S$从大到小排序，选取前$N$个单词进行考核

每次单词背诵后，向得分参数$S$加上加速度参数$a$作为新的得分参数$S$

考核时，每个单词如果错误了$n$次，则相应单词的加速度参数$a$加上$2^{n-1}$，然后，统计没有出错的单词数量，平均得减小其$a$，使得加速度参数变化量总和为$0$，该步是为了保证得分参数均值不变，防止数据溢出。

同时保留手动指定单词记忆良好的功能。

#### 英语内容

名词，包括复数，不可数

动词，包括第三人称单数，现在分词，过去式，过去分词

形容词和副词，包括部分相互转换，比较级和最高级

#### 日语内容

名词

动词，包括五段，一段，特殊动词，自动词和他动词，原形和变形

#### 俄语内容

名词形容词的性，数，格，动词时态等

## 功能划分

### 窗口控件设计

主窗口下可切换，后两个为单词窗口和考核窗口，第一个包含搜索窗口和下方面板，同时面板可切换为搜索结果窗口

窗口控件包括：主窗口，搜索栏，面板，搜索结果窗口，单词窗口，考核窗口

### 类设计

单词类，负责记录单词，词库类，负责收集单词及各种功能

### 功能分配

各窗口分别执行各自的功能，主窗口负责窗口调动，并负责词库收集等各种词库相关功能，具体功能由词库类实现

### 主要功能

- 添加单词
- 查询单词
- 编辑及删除单词
- 保存词库
- 读取词库
- 考核
- 切换语言

## 类设计

### 主窗口（MainWidget）

成员变量包括，词库

成员函数包括，主窗口切换，面板搜索切换

链接，（面板，考核，主窗口切换（到考核窗口）），（考核窗口，考核结束，主窗口切换），（搜索栏，内容改变，面板搜索切换），（搜索结果窗口，查看单词，主窗口切换），（单词窗口，返回，主窗口切换和面板搜索切换），（搜索栏，添加单词，主窗口切换）

### 搜索栏（SearchingWidget）

信号包括，内容改变（字符串参数），添加单词

链接，（单词窗口，返回，清空内容）

### 面板（Interface）

成员变量包含考核数据

成员函数包含修改考核数据（或者整体采用控件做，考核时读取）

信号包括，考核（考核类型参数）

### 搜索结果窗口（SearchingResult）

成员变量包括，单词列表

成员函数包括，显示单词列表（调用词库的该功能）

（可添加搜索结果条目类，让该类调用）

链接，（搜索栏，内容改变，显示单词列表）

信号包括，查看单词（单词参数）

### 单词窗口（DisplayWidget）

成员变量包括，单词，模式指标

成员函数包括，设置模式（显示和修改），设置显示单词，保存修改的单词（调用词库修改）

连接，（搜索结果窗口，查看单词，设置模式（显示）和设置单词和显示单词），（搜索栏，添加单词，设置模式（修改）和设置单词（新建）和显示单词）

信号包括，返回

### 考核窗口（ExamineWidget）

成员变量包括，考核设置，考核列表字符串vector，考核分数vector

成员函数包括，设置考核类型，设置考核数量，读取考核列表（从主窗口，按随机排列），启动考核（显示考核题目，统计考核得分），计算考核结果（计算新权重），储存考核单词

链接，（面板，考核，设置考核类型和数量以及读取考核列表再启动考核）

信号包括，考核结束

### 单词类（Word）

成员变量包括，单词，map属性表，从属性名称映射到属性值

成员函数包括查看与修改与添加属性，以及转化为储存字符串信息

重载比较，以单词字典序

### 词库类（WordList）

成员变量包括map映射单词字符串到单词对象和记忆权重，优先队列按权重排序

成员函数包括添加，编辑，删除单词，取出考核单词（从优先队列取，与map做核验），存考核单词，搜索（由字符串返回单词列表，默认无拼写错误和缺省）

## 界面设计

### 整体结构

主界面可在不同语言之间切换，切换按钮在左上角，选单式的上方为搜索框，可搜索单词

当搜索框有内容时，下方界面整体变为搜索结果列表

正常状态下，显示各种选项按钮，以及各种信息图表。

点击按钮，则整体界面切换到考核界面，上面为题目，下面为选项，最上为菜单，除此之外，添加单词页面，最上面为菜单，往下依次为各属性值，以及添加音频选项

整体结构为：主窗口，上方为语言选择按钮和搜索框，下方为考核项选择按钮和单词录入按钮，可切换为单词搜索列表，点击单词则弹出新窗口显示单词信息。在主窗口点击考核或录入按钮则整体切换考核或录入界面，界面上方为菜单

### 主窗口

上方固定高度语言及搜索栏，语言选择按钮宽度固定，可创建独立下拉菜单，搜索栏宽度可变

下方为考核选项和数据图表。分左右，右边为数据图表，左侧为一列考核参数选项

### 搜索列表

一列列表，单词左居中，上方词性，下方释义，单词后附带发音按钮，最有为右向小箭头

### 单词窗口

一列，单词，发音及音频按钮，词性及释义，变形，近义反义词，（词缀），例句若干及释义，左上方返回和编辑（保存）按钮，切换编辑模式

### 考核界面

一列，最上为菜单栏，左侧为返回按钮，中间为各种信息的显示，下方上题目下选项

# 进度

完成单词类，补充优先队列类，正在写词库类（单词类保存读取未写）

优先队列类集成进词库类，完成词库类

完成界面初版，即ui文件

声明变量，函数，基本完成主窗口

补充功能划分下主要功能栏目，针对单词添加功能设计单词窗口详细结构

单词窗口基本完成，还差具体保存的代码，开始进行搜索功能实现，目前不计效率，实现搜索栏的搜索效果，正在为搜索结果窗口实现单词显示控件即WordBox类

修改词库类，发现理论问题：词库内的优先队列和删除操作不相容，完成保存功能，但未检验，以及存在多次保存bug，完成搜索功能代码，但存在不显示bug，未完成查看搜索结果的按钮功能

微小的重构了单词窗口，未删除调试语句，添加了初版项目规范，经过验证添加单词功能已实现，词库类优先队列有问题，添加编辑单词函数中临时屏蔽了

重构词库类的取出考核单词部分，考虑到总词数不会太多，采用了朴素的排序，完成了基本的搜索功能和编辑功能，单词窗口单词属性相关存在问题

完善了单词窗口，修复了bug，优化代码，**单词窗口还剩属性重复相关问题没有考虑**

使用QDataStream进行序列化来保存词库，完成了

初步设计了考核窗口的工作机制，考核类型，界面

完成考核窗口两种题型的题目的展示的调用函数

初步完成考核窗口的功能，还未处理返回，以及不同题型的功能，且由于较长时间没有推进项目，之前的相关设计几乎遗忘，建议下一次**立刻着手编写初步的文档**

临时实现了删除功能